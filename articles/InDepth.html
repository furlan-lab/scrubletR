<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<meta name="description" content="scrubletR">
<title>In-depth use of ScrubletR • scrubletR</title>
<script src="../deps/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<link href="../deps/bootstrap-5.3.1/bootstrap.min.css" rel="stylesheet">
<script src="../deps/bootstrap-5.3.1/bootstrap.bundle.min.js"></script><link href="../deps/Kanit-0.4.8/font.css" rel="stylesheet">
<link href="../deps/JetBrains_Mono-0.4.8/font.css" rel="stylesheet">
<link href="../deps/Workbench-0.4.8/font.css" rel="stylesheet">
<!-- Font Awesome icons --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous">
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous">
<!-- bootstrap-toc --><script src="https://cdn.jsdelivr.net/gh/afeld/bootstrap-toc@v1.0.1/dist/bootstrap-toc.min.js" integrity="sha256-4veVQbu7//Lk5TSmc7YV48MxtMy98e26cf5MrgZYnwo=" crossorigin="anonymous"></script><!-- headroom.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script><!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script><!-- search --><script src="https://cdnjs.cloudflare.com/ajax/libs/fuse.js/6.4.6/fuse.js" integrity="sha512-zv6Ywkjyktsohkbp9bb45V6tEMoWhzFzXis+LrMehmJZZSys19Yxf1dopHx7WzIKxr5tK2dVcYmaCk2uqdjF4A==" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/autocomplete.js/0.38.0/autocomplete.jquery.min.js" integrity="sha512-GU9ayf+66Xx2TmpxqJpliWbT5PiGYxpaG8rfnBEk1LL8l1KGkRShhngwdXK1UgqhAzWpZHSiYPc09/NwDQIGyg==" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mark.js/8.11.1/mark.min.js" integrity="sha512-5CYOlHXGh6QpOFA/TeTylKLWfB3ftPsde7AnmhuitiTX4K5SqCLBeKro6sPS8ilsz1Q4NRx3v8Ko2IBiszzdww==" crossorigin="anonymous"></script><!-- pkgdown --><script src="../pkgdown.js"></script><link href="../extra.css" rel="stylesheet">
<meta property="og:title" content="In-depth use of ScrubletR">
<meta property="og:description" content="scrubletR">
<!-- mathjax --><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]-->
</head>
<body>
    <a href="#main" class="visually-hidden-focusable">Skip to contents</a>
    

    <nav class="navbar fixed-top navbar-dark navbar-expand-lg bg-primary"><div class="container">
    
    <a class="navbar-brand me-2" href="../index.html">scrubletR</a>

    <small class="nav-text text-muted me-auto" data-bs-toggle="tooltip" data-bs-placement="bottom" title="">0.1.1</small>

    
    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbar" aria-controls="navbar" aria-expanded="false" aria-label="Toggle navigation">
      <span class="navbar-toggler-icon"></span>
    </button>

    <div id="navbar" class="collapse navbar-collapse ms-3">
      <ul class="navbar-nav me-auto">
<li class="nav-item">
  <a class="nav-link" href="../reference/index.html">Reference</a>
</li>
<li class="active nav-item dropdown">
  <a href="#" class="nav-link dropdown-toggle" data-bs-toggle="dropdown" role="button" aria-expanded="false" aria-haspopup="true" id="dropdown-articles">Articles</a>
  <div class="dropdown-menu" aria-labelledby="dropdown-articles">
    <h6 class="dropdown-header" data-toc-skip>Get Started</h6>
    <a class="dropdown-item" href="../articles/QuickStart.html">Quick Start to ScrubletR</a>
    <div class="dropdown-divider"></div>
    <h6 class="dropdown-header" data-toc-skip>Advanced</h6>
    <a class="dropdown-item" href="../articles/InDepth.html">In-depth use of ScrubletR</a>
    <a class="dropdown-item" href="../articles/ImplementationHassles.html">Implementing Scrublet in R</a>
  </div>
</li>
<li class="nav-item">
  <a class="nav-link" href="../news/index.html">Changelog</a>
</li>
      </ul>
<form class="form-inline my-2 my-lg-0" role="search">
        <input type="search" class="form-control me-sm-2" aria-label="Toggle navigation" name="search-input" data-search-index="../search.json" id="search-input" placeholder="Search for" autocomplete="off">
</form>

      <ul class="navbar-nav">
<li class="nav-item">
  <a class="external-link nav-link" href="http://twitter.com/scottfurlan" aria-label="Twitter">
    <span class="fa fa-twitter"></span>
     
  </a>
</li>
<li class="nav-item">
  <a class="external-link nav-link" href="https://github.com/furlan-lab/scrubletR" aria-label="GitHub">
    <span class="fa fa-github"></span>
     
  </a>
</li>
      </ul>
</div>

    
  </div>
</nav><div class="container template-article">




<div class="row">
  <main id="main" class="col-md-9"><div class="page-header">
      <img src="" class="logo" alt=""><h1>In-depth use of ScrubletR</h1>
            
            <h4 data-toc-skip class="date">2024-02-02</h4>
      
      
      <div class="d-none name"><code>InDepth.Rmd</code></div>
    </div>

    
    
<div class="section level2">
<h2 id="installing-scrubletr">Installing scrubletR<a class="anchor" aria-label="anchor" href="#installing-scrubletr"></a>
</h2>
<p>You will need to have the devtools package installed…</p>
<div class="sourceCode" id="cb1"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu">devtools</span><span class="fu">::</span><span class="fu"><a href="https://remotes.r-lib.org/reference/install_github.html" class="external-link">install_github</a></span><span class="op">(</span><span class="st">"furlan-lab/scrubletR"</span><span class="op">)</span></span></code></pre></div>
</div>
<div class="section level2">
<h2 id="load-data">Load data<a class="anchor" aria-label="anchor" href="#load-data"></a>
</h2>
<p>Let’s read in a 10X dataset where T cells from two donors were
combined before capture. We then use souporcell to detect genetic
demultiplets. Clustering in higher dimension actually works better for
visualizing the SNP clustering… First we read in the pca-transformed
probability scores from souporcell algorithm which enables us to
visualize the two expected genotypes but having set k=3 enables 3
dimensions of data from the algorithm (the first dimension is ‘cell
size’ aka UMI count per cell). Therefore we visualize the embedding
using the 2nd and 3rd PCs, but label the cells according to their label
setting k=2. The following code loads the 10X data, the souporcell data
and makes the plot.</p>
<div class="sourceCode" id="cb2"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/base/rm.html" class="external-link">rm</a></span><span class="op">(</span>list <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/ls.html" class="external-link">ls</a></span><span class="op">(</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/message.html" class="external-link">suppressPackageStartupMessages</a></span><span class="op">(</span><span class="op">{</span></span>
<span>  <span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://furlan-lab.github.io/viewmastRust/" class="external-link">viewmastRust</a></span><span class="op">)</span></span>
<span>  <span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://satijalab.org/seurat" class="external-link">Seurat</a></span><span class="op">)</span></span>
<span>  <span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://github.com/samuel-marsh/scCustomize" class="external-link">scCustomize</a></span><span class="op">)</span></span>
<span>  <span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://furlan-lab.github.io/scrubletR/">scrubletR</a></span><span class="op">)</span></span>
<span>  <span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://ggplot2.tidyverse.org" class="external-link">ggplot2</a></span><span class="op">)</span></span>
<span>  <span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://magrittr.tidyverse.org" class="external-link">magrittr</a></span><span class="op">)</span></span>
<span><span class="op">}</span><span class="op">)</span></span>
<span></span>
<span><span class="kw">if</span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/grep.html" class="external-link">grepl</a></span><span class="op">(</span><span class="st">"^gizmo"</span>, <span class="fu"><a href="https://rdrr.io/r/base/Sys.info.html" class="external-link">Sys.info</a></span><span class="op">(</span><span class="op">)</span><span class="op">[</span><span class="st">"nodename"</span><span class="op">]</span><span class="op">)</span><span class="op">)</span><span class="op">{</span></span>
<span>  <span class="va">ROOT_DIR2</span><span class="op">&lt;-</span><span class="st">"/fh/fast/furlan_s/grp/data/experiments/MM_CarT_5p_vdjt/data/SNF"</span></span>
<span><span class="op">}</span> <span class="kw">else</span> <span class="op">{</span></span>
<span>  <span class="va">ROOT_DIR2</span><span class="op">&lt;-</span><span class="st">"/Users/sfurlan/Library/CloudStorage/OneDrive-SharedLibraries-FredHutchinsonCancerCenter/Furlan_Lab - General/experiments/MM_CART/SNF"</span></span>
<span><span class="op">}</span></span>
<span><span class="va">counts</span><span class="op">&lt;-</span><span class="fu"><a href="https://satijalab.org/seurat/reference/Read10X_h5.html" class="external-link">Read10X_h5</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/file.path.html" class="external-link">file.path</a></span><span class="op">(</span><span class="va">ROOT_DIR2</span>, <span class="st">"sample_filtered_feature_bc_matrix.h5"</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/colnames.html" class="external-link">colnames</a></span><span class="op">(</span><span class="va">counts</span><span class="op">$</span><span class="va">`Gene Expression`</span><span class="op">)</span><span class="op">&lt;-</span><span class="fu"><a href="https://rdrr.io/r/base/paste.html" class="external-link">paste0</a></span><span class="op">(</span><span class="st">"JP_709_707_IP_"</span>, <span class="fu"><a href="https://rdrr.io/r/base/colnames.html" class="external-link">colnames</a></span><span class="op">(</span><span class="va">counts</span><span class="op">$</span><span class="va">`Gene Expression`</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="va">seu</span><span class="op">&lt;-</span><span class="fu"><a href="https://rdrr.io/pkg/SeuratObject/man/CreateSeuratObject.html" class="external-link">CreateSeuratObject</a></span><span class="op">(</span><span class="va">counts</span><span class="op">$</span><span class="va">`Gene Expression`</span><span class="op">)</span></span>
<span></span>
<span><span class="va">scdata</span><span class="op">&lt;-</span><span class="fu">data.table</span><span class="fu">::</span><span class="fu"><a href="https://rdatatable.gitlab.io/data.table/reference/fread.html" class="external-link">fread</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/file.path.html" class="external-link">file.path</a></span><span class="op">(</span><span class="va">ROOT_DIR2</span>, <span class="st">"clusters_3.tsv"</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="va">seu</span><span class="op">&lt;-</span><span class="va">seu</span><span class="op">[</span>,<span class="fu"><a href="https://rdrr.io/pkg/SeuratObject/man/Cells.html" class="external-link">Cells</a></span><span class="op">(</span><span class="va">seu</span><span class="op">)</span> <span class="op"><a href="https://rdrr.io/r/base/match.html" class="external-link">%in%</a></span> <span class="va">scdata</span><span class="op">$</span><span class="va">barcode</span><span class="op">]</span></span>
<span><span class="va">seu</span><span class="op">&lt;-</span><span class="fu"><a href="https://furlan-lab.github.io/viewmastRust/reference/add_souporcell_seurat.html" class="external-link">add_souporcell_seurat</a></span><span class="op">(</span><span class="va">seu</span>, <span class="fu"><a href="https://rdrr.io/r/base/file.path.html" class="external-link">file.path</a></span><span class="op">(</span><span class="va">ROOT_DIR2</span>, <span class="st">"clusters_3.tsv"</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="va">scdata</span><span class="op">&lt;-</span><span class="fu">data.table</span><span class="fu">::</span><span class="fu"><a href="https://rdatatable.gitlab.io/data.table/reference/fread.html" class="external-link">fread</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/file.path.html" class="external-link">file.path</a></span><span class="op">(</span><span class="va">ROOT_DIR2</span>, <span class="st">"clusters_2.tsv"</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="va">seu</span><span class="op">$</span><span class="va">geno_from2</span><span class="op">&lt;-</span><span class="va">scdata</span><span class="op">$</span><span class="va">assignment</span><span class="op">[</span><span class="fu"><a href="https://rdrr.io/r/base/match.html" class="external-link">match</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/pkg/SeuratObject/man/Cells.html" class="external-link">Cells</a></span><span class="op">(</span><span class="va">seu</span><span class="op">)</span>, <span class="va">scdata</span><span class="op">$</span><span class="va">barcode</span><span class="op">)</span><span class="op">]</span></span>
<span><span class="va">seu</span><span class="op">$</span><span class="va">geno_from2</span><span class="op">[</span><span class="fu"><a href="https://rdrr.io/r/base/grep.html" class="external-link">grepl</a></span><span class="op">(</span><span class="st">"\\/"</span>, <span class="va">seu</span><span class="op">$</span><span class="va">geno_from2</span><span class="op">)</span><span class="op">]</span><span class="op">&lt;-</span><span class="st">"Multiplet"</span></span>
<span><span class="fu"><a href="https://satijalab.org/seurat/reference/DimPlot.html" class="external-link">DimPlot</a></span><span class="op">(</span><span class="va">seu</span>, group.by <span class="op">=</span> <span class="st">"geno_from2"</span>, dims <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">2</span>,<span class="fl">3</span><span class="op">)</span>, cols <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"black"</span>, <span class="st">"grey"</span>, <span class="st">"red"</span><span class="op">)</span><span class="op">)</span><span class="op">+</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/labs.html" class="external-link">ggtitle</a></span><span class="op">(</span><span class="st">"Souporcell data (overclustered)"</span><span class="op">)</span></span></code></pre></div>
<p><img src="InDepth_files/figure-html/unnamed-chunk-2-1.png" width="100%"></p>
</div>
<div class="section level2">
<h2 id="calculate-doublet-rate">Calculate doublet rate<a class="anchor" aria-label="anchor" href="#calculate-doublet-rate"></a>
</h2>
<div class="sourceCode" id="cb3"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/base/table.html" class="external-link">table</a></span><span class="op">(</span><span class="va">seu</span><span class="op">$</span><span class="va">geno_from2</span><span class="op">)</span><span class="op">/</span><span class="fu"><a href="https://rdrr.io/r/base/dim.html" class="external-link">dim</a></span><span class="op">(</span><span class="va">seu</span><span class="op">)</span><span class="op">[</span><span class="fl">2</span><span class="op">]</span></span></code></pre></div>
<pre><code><span><span class="co">## </span></span>
<span><span class="co">##         0         1 Multiplet </span></span>
<span><span class="co">## 0.4387415 0.4950052 0.0662533</span></span></code></pre>
<p><strong>Looks to be 6.6%.</strong> This is what we would expect from
a 10X capture of this size.</p>
</div>
<div class="section level2">
<h2 id="run-scrublet">Run scrublet<a class="anchor" aria-label="anchor" href="#run-scrublet"></a>
</h2>
<div class="sourceCode" id="cb5"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">seu</span><span class="op">&lt;-</span><span class="fu"><a href="../reference/scrublet.html">scrublet</a></span><span class="op">(</span><span class="va">seu</span><span class="op">)</span></span></code></pre></div>
<p><img src="InDepth_files/figure-html/unnamed-chunk-4-1.png" width="100%"></p>
<div class="sourceCode" id="cb6"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">seu</span><span class="op">$</span><span class="va">log_ds</span><span class="op">&lt;-</span><span class="fu"><a href="https://rdrr.io/r/base/Log.html" class="external-link">log</a></span><span class="op">(</span><span class="va">seu</span><span class="op">$</span><span class="va">doublet_scores</span><span class="op">)</span></span>
<span></span>
<span><span class="fu"><a href="https://samuel-marsh.github.io/scCustomize/reference/VlnPlot_scCustom.html" class="external-link">VlnPlot_scCustom</a></span><span class="op">(</span><span class="va">seu</span>, features <span class="op">=</span> <span class="st">"log_ds"</span>, group.by <span class="op">=</span> <span class="st">"geno_from2"</span>, pt.size <span class="op">=</span> <span class="fl">0</span><span class="op">)</span></span></code></pre></div>
<p><img src="InDepth_files/figure-html/unnamed-chunk-4-2.png" width="100%"></p>
<p>This looks okay. The genetic multiplets have ~ 2 fold increase in
scrublet doublet score than cells from each genotype. This is of course
not the whole story as we would expect that more than one cell from the
same donor could end up in the same droplet. Therefore &gt; 6 percent of
the cells in ‘0’ and ‘1’ genotypes above will also be multiplets. Let’s
set a threshold and see how the percents fall out.</p>
<div class="sourceCode" id="cb7"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">thresh</span><span class="op">&lt;-</span><span class="op">(</span><span class="op">-</span><span class="fl">1.6</span><span class="op">)</span></span>
<span><span class="va">seu</span><span class="op">$</span><span class="va">SFdoublet</span><span class="op">&lt;-</span><span class="va">seu</span><span class="op">$</span><span class="va">log_ds</span><span class="op">&gt;</span><span class="op">(</span><span class="va">thresh</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/table.html" class="external-link">table</a></span><span class="op">(</span><span class="va">seu</span><span class="op">$</span><span class="va">SFdoublet</span>, <span class="va">seu</span><span class="op">$</span><span class="va">geno_from2</span><span class="op">)</span></span></code></pre></div>
<pre><code><span><span class="co">##        </span></span>
<span><span class="co">##            0    1 Multiplet</span></span>
<span><span class="co">##   FALSE 3027 3554       359</span></span>
<span><span class="co">##   TRUE   794  757       218</span></span></code></pre>
<div class="sourceCode" id="cb9"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://samuel-marsh.github.io/scCustomize/reference/VlnPlot_scCustom.html" class="external-link">VlnPlot_scCustom</a></span><span class="op">(</span><span class="va">seu</span>, features <span class="op">=</span> <span class="st">"log_ds"</span>, group.by <span class="op">=</span> <span class="st">"geno_from2"</span>, pt.size <span class="op">=</span> <span class="fl">0</span><span class="op">)</span><span class="op">+</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_abline.html" class="external-link">geom_hline</a></span><span class="op">(</span>yintercept <span class="op">=</span> <span class="va">thresh</span><span class="op">)</span></span></code></pre></div>
<p><img src="InDepth_files/figure-html/unnamed-chunk-5-1.png" width="100%"></p>
<div class="sourceCode" id="cb10"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://satijalab.org/seurat/reference/DimPlot.html" class="external-link">DimPlot</a></span><span class="op">(</span><span class="va">seu</span>, group.by <span class="op">=</span> <span class="st">"SFdoublet"</span>, dims <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">2</span>,<span class="fl">3</span><span class="op">)</span>, pt.size <span class="op">=</span> <span class="fl">0.4</span><span class="op">)</span></span></code></pre></div>
<p><img src="InDepth_files/figure-html/unnamed-chunk-6-1.png" width="100%"></p>
</div>
<div class="section level2">
<h2 id="visualize">Visualize<a class="anchor" aria-label="anchor" href="#visualize"></a>
</h2>
<p>Let’s visualize, subset, and re-embed. But first we need to remove
the geno assay (seurat 5 is broken)</p>
<div class="sourceCode" id="cb11"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/pkg/SeuratObject/man/DefaultAssay.html" class="external-link">DefaultAssay</a></span><span class="op">(</span><span class="va">seu</span><span class="op">)</span><span class="op">&lt;-</span><span class="st">"RNA"</span></span>
<span><span class="va">seu</span> <span class="op">&lt;-</span><span class="fu"><a href="https://satijalab.org/seurat/reference/NormalizeData.html" class="external-link">NormalizeData</a></span><span class="op">(</span><span class="va">seu</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span> <span class="fu"><a href="https://satijalab.org/seurat/reference/FindVariableFeatures.html" class="external-link">FindVariableFeatures</a></span><span class="op">(</span>nfeatures <span class="op">=</span> <span class="fl">3000</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span> <span class="fu"><a href="https://satijalab.org/seurat/reference/ScaleData.html" class="external-link">ScaleData</a></span><span class="op">(</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span> <span class="fu"><a href="https://satijalab.org/seurat/reference/RunPCA.html" class="external-link">RunPCA</a></span><span class="op">(</span>npcs <span class="op">=</span> <span class="fl">50</span><span class="op">)</span></span>
<span><span class="co">#ElbowPlot(seu, 50) </span></span>
<span><span class="va">seu</span><span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/invisible.html" class="external-link">invisible</a></span><span class="op">(</span><span class="fu"><a href="https://satijalab.org/seurat/reference/FindNeighbors.html" class="external-link">FindNeighbors</a></span><span class="op">(</span><span class="va">seu</span>, dims <span class="op">=</span> <span class="fl">1</span><span class="op">:</span><span class="fl">30</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span> <span class="fu"><a href="https://satijalab.org/seurat/reference/FindClusters.html" class="external-link">FindClusters</a></span><span class="op">(</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span> <span class="fu"><a href="https://satijalab.org/seurat/reference/RunUMAP.html" class="external-link">RunUMAP</a></span><span class="op">(</span>dims <span class="op">=</span> <span class="fl">1</span><span class="op">:</span><span class="fl">30</span><span class="op">)</span><span class="op">)</span></span></code></pre></div>
<pre><code><span><span class="co">## Modularity Optimizer version 1.3.0 by Ludo Waltman and Nees Jan van Eck</span></span>
<span><span class="co">## </span></span>
<span><span class="co">## Number of nodes: 8709</span></span>
<span><span class="co">## Number of edges: 354588</span></span>
<span><span class="co">## </span></span>
<span><span class="co">## Running Louvain algorithm...</span></span>
<span><span class="co">## Maximum modularity in 10 random starts: 0.8566</span></span>
<span><span class="co">## Number of communities: 13</span></span>
<span><span class="co">## Elapsed time: 0 seconds</span></span></code></pre>
<div class="sourceCode" id="cb13"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://satijalab.org/seurat/reference/DimPlot.html" class="external-link">DimPlot</a></span><span class="op">(</span><span class="va">seu</span><span class="op">)</span></span></code></pre></div>
<p><img src="InDepth_files/figure-html/unnamed-chunk-7-1.png" width="100%"></p>
<div class="sourceCode" id="cb14"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://samuel-marsh.github.io/scCustomize/reference/FeaturePlot_scCustom.html" class="external-link">FeaturePlot_scCustom</a></span><span class="op">(</span><span class="va">seu</span>, features <span class="op">=</span> <span class="st">"CD4"</span><span class="op">)</span></span></code></pre></div>
<p><img src="InDepth_files/figure-html/unnamed-chunk-7-2.png" width="100%"></p>
<div class="sourceCode" id="cb15"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://samuel-marsh.github.io/scCustomize/reference/FeaturePlot_scCustom.html" class="external-link">FeaturePlot_scCustom</a></span><span class="op">(</span><span class="va">seu</span>, features <span class="op">=</span> <span class="st">"CD8A"</span><span class="op">)</span></span></code></pre></div>
<p><img src="InDepth_files/figure-html/unnamed-chunk-7-3.png" width="100%"></p>
<div class="sourceCode" id="cb16"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://satijalab.org/seurat/reference/DimPlot.html" class="external-link">DimPlot</a></span><span class="op">(</span><span class="va">seu</span>, group.by <span class="op">=</span> <span class="st">"SFdoublet"</span><span class="op">)</span></span></code></pre></div>
<p><img src="InDepth_files/figure-html/unnamed-chunk-7-4.png" width="100%"></p>
<div class="sourceCode" id="cb17"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://satijalab.org/seurat/reference/DimPlot.html" class="external-link">DimPlot</a></span><span class="op">(</span><span class="va">seu</span>, group.by <span class="op">=</span> <span class="st">"geno_from2"</span><span class="op">)</span></span></code></pre></div>
<p><img src="InDepth_files/figure-html/unnamed-chunk-7-5.png" width="100%"></p>
<div class="sourceCode" id="cb18"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">seu</span><span class="op">$</span><span class="va">cell_bool</span><span class="op">&lt;-</span><span class="op">!</span><span class="va">seu</span><span class="op">$</span><span class="va">SFdoublet</span> <span class="op">&amp;</span> <span class="va">seu</span><span class="op">$</span><span class="va">geno_from2</span> <span class="op">!=</span> <span class="st">"Multiplet"</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/table.html" class="external-link">table</a></span><span class="op">(</span><span class="va">seu</span><span class="op">$</span><span class="va">cell_bool</span><span class="op">)</span></span></code></pre></div>
<pre><code><span><span class="co">## </span></span>
<span><span class="co">## FALSE  TRUE </span></span>
<span><span class="co">##  2128  6581</span></span></code></pre>
<div class="sourceCode" id="cb20"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://satijalab.org/seurat/reference/DimPlot.html" class="external-link">DimPlot</a></span><span class="op">(</span><span class="va">seu</span>, group.by <span class="op">=</span> <span class="st">"cell_bool"</span><span class="op">)</span></span></code></pre></div>
<p><img src="InDepth_files/figure-html/unnamed-chunk-7-6.png" width="100%"></p>
<div class="sourceCode" id="cb21"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">subset_cells_seurat</span><span class="op">&lt;-</span><span class="kw">function</span><span class="op">(</span><span class="va">seu</span>, <span class="va">cell_bool</span><span class="op">)</span><span class="op">{</span></span>
<span>  <span class="kw">if</span><span class="op">(</span><span class="op">!</span><span class="fu"><a href="https://rdrr.io/r/base/length.html" class="external-link">length</a></span><span class="op">(</span><span class="va">cell_bool</span><span class="op">)</span><span class="op">==</span><span class="fu"><a href="https://rdrr.io/r/base/length.html" class="external-link">length</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/pkg/SeuratObject/man/Cells.html" class="external-link">Cells</a></span><span class="op">(</span><span class="va">seu</span><span class="op">)</span><span class="op">)</span><span class="op">)</span><span class="op">{</span><span class="kw"><a href="https://rdrr.io/r/base/stop.html" class="external-link">stop</a></span><span class="op">(</span><span class="st">"cell_bool argument length does not match the number of cells in Seurat object"</span><span class="op">)</span><span class="op">}</span></span>
<span>  <span class="va">assays</span><span class="op">&lt;-</span><span class="fu"><a href="https://rdrr.io/pkg/SeuratObject/man/ObjectAccess.html" class="external-link">Assays</a></span><span class="op">(</span><span class="va">seu</span><span class="op">)</span></span>
<span>  <span class="fu"><a href="https://rdrr.io/r/base/warning.html" class="external-link">suppressWarnings</a></span><span class="op">(</span><span class="va">layers</span><span class="op">&lt;-</span><span class="fu"><a href="https://rdrr.io/r/base/lapply.html" class="external-link">lapply</a></span><span class="op">(</span><span class="va">assays</span>, <span class="kw">function</span><span class="op">(</span><span class="va">assay</span><span class="op">)</span> <span class="op">{</span></span>
<span>    <span class="fu"><a href="https://rdrr.io/r/base/subset.html" class="external-link">subset</a></span><span class="op">(</span><span class="fu"><a href="https://satijalab.org/seurat/reference/GetAssay.html" class="external-link">GetAssay</a></span><span class="op">(</span><span class="va">seu</span>, assay <span class="op">=</span> <span class="va">assay</span><span class="op">)</span>, <span class="fu"><a href="https://rdrr.io/pkg/SeuratObject/man/Cells.html" class="external-link">Cells</a></span><span class="op">(</span><span class="va">seu</span><span class="op">)</span><span class="op">[</span><span class="va">cell_bool</span><span class="op">]</span><span class="op">)</span> </span>
<span>  <span class="op">}</span><span class="op">)</span><span class="op">)</span></span>
<span>  <span class="va">newseu</span><span class="op">&lt;-</span><span class="fu"><a href="https://rdrr.io/pkg/SeuratObject/man/CreateSeuratObject.html" class="external-link">CreateSeuratObject</a></span><span class="op">(</span><span class="va">layers</span><span class="op">[[</span><span class="fl">1</span><span class="op">]</span><span class="op">]</span>, meta.data <span class="op">=</span> <span class="va">seu</span><span class="op">@</span><span class="va">meta.data</span><span class="op">[</span><span class="va">cell_bool</span>,<span class="op">]</span><span class="op">)</span></span>
<span>  <span class="kw">for</span><span class="op">(</span><span class="va">i</span> <span class="kw">in</span> <span class="fl">2</span><span class="op">:</span><span class="fu"><a href="https://rdrr.io/r/base/length.html" class="external-link">length</a></span><span class="op">(</span><span class="va">assays</span><span class="op">)</span><span class="op">)</span><span class="op">{</span></span>
<span>    <span class="va">newseu</span><span class="op">[[</span><span class="va">assays</span><span class="op">[</span><span class="va">i</span><span class="op">]</span><span class="op">]</span><span class="op">]</span><span class="op">&lt;-</span><span class="va">layers</span><span class="op">[[</span><span class="va">i</span><span class="op">]</span><span class="op">]</span></span>
<span>  <span class="op">}</span></span>
<span>  <span class="va">newseu</span></span>
<span><span class="op">}</span></span>
<span></span>
<span><span class="va">seu</span><span class="op">&lt;-</span><span class="fu">subset_cells_seurat</span><span class="op">(</span><span class="va">seu</span>, <span class="va">seu</span><span class="op">$</span><span class="va">cell_bool</span><span class="op">)</span></span>
<span></span>
<span></span>
<span><span class="va">seu</span> <span class="op">&lt;-</span><span class="fu"><a href="https://satijalab.org/seurat/reference/NormalizeData.html" class="external-link">NormalizeData</a></span><span class="op">(</span><span class="va">seu</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span> <span class="fu"><a href="https://satijalab.org/seurat/reference/FindVariableFeatures.html" class="external-link">FindVariableFeatures</a></span><span class="op">(</span>nfeatures <span class="op">=</span> <span class="fl">3000</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span> <span class="fu"><a href="https://satijalab.org/seurat/reference/ScaleData.html" class="external-link">ScaleData</a></span><span class="op">(</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span> <span class="fu"><a href="https://satijalab.org/seurat/reference/RunPCA.html" class="external-link">RunPCA</a></span><span class="op">(</span>npcs <span class="op">=</span> <span class="fl">50</span><span class="op">)</span></span>
<span><span class="co">#ElbowPlot(seu, 50) </span></span>
<span><span class="va">seu</span><span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/invisible.html" class="external-link">invisible</a></span><span class="op">(</span><span class="fu"><a href="https://satijalab.org/seurat/reference/FindNeighbors.html" class="external-link">FindNeighbors</a></span><span class="op">(</span><span class="va">seu</span>, dims <span class="op">=</span> <span class="fl">1</span><span class="op">:</span><span class="fl">30</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span> <span class="fu"><a href="https://satijalab.org/seurat/reference/FindClusters.html" class="external-link">FindClusters</a></span><span class="op">(</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span> <span class="fu"><a href="https://satijalab.org/seurat/reference/RunUMAP.html" class="external-link">RunUMAP</a></span><span class="op">(</span>dims <span class="op">=</span> <span class="fl">1</span><span class="op">:</span><span class="fl">30</span><span class="op">)</span><span class="op">)</span></span></code></pre></div>
<pre><code><span><span class="co">## Modularity Optimizer version 1.3.0 by Ludo Waltman and Nees Jan van Eck</span></span>
<span><span class="co">## </span></span>
<span><span class="co">## Number of nodes: 6581</span></span>
<span><span class="co">## Number of edges: 273740</span></span>
<span><span class="co">## </span></span>
<span><span class="co">## Running Louvain algorithm...</span></span>
<span><span class="co">## Maximum modularity in 10 random starts: 0.8605</span></span>
<span><span class="co">## Number of communities: 12</span></span>
<span><span class="co">## Elapsed time: 0 seconds</span></span></code></pre>
<div class="sourceCode" id="cb23"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://satijalab.org/seurat/reference/DimPlot.html" class="external-link">DimPlot</a></span><span class="op">(</span><span class="va">seu</span><span class="op">)</span></span></code></pre></div>
<p><img src="InDepth_files/figure-html/unnamed-chunk-7-7.png" width="100%"></p>
<div class="sourceCode" id="cb24"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://samuel-marsh.github.io/scCustomize/reference/FeaturePlot_scCustom.html" class="external-link">FeaturePlot_scCustom</a></span><span class="op">(</span><span class="va">seu</span>, features <span class="op">=</span> <span class="st">"doublet_scores"</span><span class="op">)</span></span></code></pre></div>
<p><img src="InDepth_files/figure-html/unnamed-chunk-7-8.png" width="100%"></p>
</div>
<div class="section level2">
<h2 id="rerun-scrublet">Rerun scrublet<a class="anchor" aria-label="anchor" href="#rerun-scrublet"></a>
</h2>
<div class="sourceCode" id="cb25"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">seu</span><span class="op">&lt;-</span><span class="fu"><a href="../reference/scrublet.html">scrublet</a></span><span class="op">(</span><span class="va">seu</span><span class="op">)</span></span></code></pre></div>
<p><img src="InDepth_files/figure-html/unnamed-chunk-8-1.png" width="100%"></p>
<div class="sourceCode" id="cb26"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://samuel-marsh.github.io/scCustomize/reference/FeaturePlot_scCustom.html" class="external-link">FeaturePlot_scCustom</a></span><span class="op">(</span><span class="va">seu</span>, features <span class="op">=</span> <span class="st">"doublet_scores"</span><span class="op">)</span></span></code></pre></div>
<p><img src="InDepth_files/figure-html/unnamed-chunk-8-2.png" width="100%"></p>
<div class="sourceCode" id="cb27"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://satijalab.org/seurat/reference/DimPlot.html" class="external-link">DimPlot</a></span><span class="op">(</span><span class="va">seu</span><span class="op">)</span></span></code></pre></div>
<p><img src="InDepth_files/figure-html/unnamed-chunk-8-3.png" width="100%"></p>
<div class="sourceCode" id="cb28"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://samuel-marsh.github.io/scCustomize/reference/FeaturePlot_scCustom.html" class="external-link">FeaturePlot_scCustom</a></span><span class="op">(</span><span class="va">seu</span>, features <span class="op">=</span> <span class="st">"CD4"</span><span class="op">)</span></span></code></pre></div>
<p><img src="InDepth_files/figure-html/unnamed-chunk-8-4.png" width="100%"></p>
<div class="sourceCode" id="cb29"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://samuel-marsh.github.io/scCustomize/reference/FeaturePlot_scCustom.html" class="external-link">FeaturePlot_scCustom</a></span><span class="op">(</span><span class="va">seu</span>, features <span class="op">=</span> <span class="st">"CD8A"</span><span class="op">)</span></span></code></pre></div>
<p><img src="InDepth_files/figure-html/unnamed-chunk-8-5.png" width="100%"></p>
<p><strong>Much better</strong>. We see the data is more simple and we
have more readily distinguishable clusters. ## Appendix</p>
<div class="sourceCode" id="cb30"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/utils/sessionInfo.html" class="external-link">sessionInfo</a></span><span class="op">(</span><span class="op">)</span></span></code></pre></div>
<pre><code><span><span class="co">## R version 4.3.1 (2023-06-16)</span></span>
<span><span class="co">## Platform: x86_64-apple-darwin20 (64-bit)</span></span>
<span><span class="co">## Running under: macOS Ventura 13.6.3</span></span>
<span><span class="co">## </span></span>
<span><span class="co">## Matrix products: default</span></span>
<span><span class="co">## BLAS:   /Library/Frameworks/R.framework/Versions/4.3-x86_64/Resources/lib/libRblas.0.dylib </span></span>
<span><span class="co">## LAPACK: /Library/Frameworks/R.framework/Versions/4.3-x86_64/Resources/lib/libRlapack.dylib;  LAPACK version 3.11.0</span></span>
<span><span class="co">## </span></span>
<span><span class="co">## locale:</span></span>
<span><span class="co">## [1] en_US.UTF-8/en_US.UTF-8/en_US.UTF-8/C/en_US.UTF-8/en_US.UTF-8</span></span>
<span><span class="co">## </span></span>
<span><span class="co">## time zone: America/Los_Angeles</span></span>
<span><span class="co">## tzcode source: internal</span></span>
<span><span class="co">## </span></span>
<span><span class="co">## attached base packages:</span></span>
<span><span class="co">## [1] stats     graphics  grDevices utils     datasets  methods   base     </span></span>
<span><span class="co">## </span></span>
<span><span class="co">## other attached packages:</span></span>
<span><span class="co">## [1] magrittr_2.0.3       ggplot2_3.4.4        scrubletR_0.1.1     </span></span>
<span><span class="co">## [4] scCustomize_2.0.1    Seurat_5.0.1.9004    SeuratObject_5.0.1  </span></span>
<span><span class="co">## [7] sp_2.1-3             viewmastRust_0.1.5.1</span></span>
<span><span class="co">## </span></span>
<span><span class="co">## loaded via a namespace (and not attached):</span></span>
<span><span class="co">##   [1] fs_1.6.3                    matrixStats_1.2.0          </span></span>
<span><span class="co">##   [3] spatstat.sparse_3.0-3       bitops_1.0-7               </span></span>
<span><span class="co">##   [5] lubridate_1.9.3             httr_1.4.7                 </span></span>
<span><span class="co">##   [7] RColorBrewer_1.1-3          doParallel_1.0.17          </span></span>
<span><span class="co">##   [9] tools_4.3.1                 sctransform_0.4.1          </span></span>
<span><span class="co">##  [11] backports_1.4.1             utf8_1.2.4                 </span></span>
<span><span class="co">##  [13] R6_2.5.1                    lazyeval_0.2.2             </span></span>
<span><span class="co">##  [15] uwot_0.1.16                 GetoptLong_1.0.5           </span></span>
<span><span class="co">##  [17] withr_3.0.0                 gridExtra_2.3              </span></span>
<span><span class="co">##  [19] progressr_0.14.0            cli_3.6.2                  </span></span>
<span><span class="co">##  [21] Biobase_2.60.0              textshaping_0.3.7          </span></span>
<span><span class="co">##  [23] spatstat.explore_3.2-6      fastDummies_1.7.3          </span></span>
<span><span class="co">##  [25] labeling_0.4.3              sass_0.4.8                 </span></span>
<span><span class="co">##  [27] spatstat.data_3.0-4         ggridges_0.5.6             </span></span>
<span><span class="co">##  [29] pbapply_1.7-2               pkgdown_2.0.7              </span></span>
<span><span class="co">##  [31] systemfonts_1.0.5           foreign_0.8-86             </span></span>
<span><span class="co">##  [33] parallelly_1.36.0           rstudioapi_0.15.0          </span></span>
<span><span class="co">##  [35] generics_0.1.3              shape_1.4.6                </span></span>
<span><span class="co">##  [37] ica_1.0-3                   spatstat.random_3.2-2      </span></span>
<span><span class="co">##  [39] dplyr_1.1.4                 Matrix_1.6-5               </span></span>
<span><span class="co">##  [41] ggbeeswarm_0.7.2            fansi_1.0.6                </span></span>
<span><span class="co">##  [43] S4Vectors_0.38.2            abind_1.4-5                </span></span>
<span><span class="co">##  [45] lifecycle_1.0.4             yaml_2.3.8                 </span></span>
<span><span class="co">##  [47] snakecase_0.11.1            SummarizedExperiment_1.30.2</span></span>
<span><span class="co">##  [49] recipes_1.0.9               Rtsne_0.17                 </span></span>
<span><span class="co">##  [51] paletteer_1.6.0             grid_4.3.1                 </span></span>
<span><span class="co">##  [53] promises_1.2.1              crayon_1.5.2               </span></span>
<span><span class="co">##  [55] miniUI_0.1.1.1              lattice_0.22-5             </span></span>
<span><span class="co">##  [57] cowplot_1.1.3               pillar_1.9.0               </span></span>
<span><span class="co">##  [59] knitr_1.45                  ComplexHeatmap_2.16.0      </span></span>
<span><span class="co">##  [61] GenomicRanges_1.52.1        rjson_0.2.21               </span></span>
<span><span class="co">##  [63] boot_1.3-28.1               future.apply_1.11.1        </span></span>
<span><span class="co">##  [65] codetools_0.2-19            leiden_0.4.3.1             </span></span>
<span><span class="co">##  [67] glue_1.7.0                  MatrixExtra_0.1.15         </span></span>
<span><span class="co">##  [69] data.table_1.15.0           float_0.3-2                </span></span>
<span><span class="co">##  [71] vctrs_0.6.5                 png_0.1-8                  </span></span>
<span><span class="co">##  [73] spam_2.10-0                 gtable_0.3.4               </span></span>
<span><span class="co">##  [75] rematch2_2.1.2              assertthat_0.2.1           </span></span>
<span><span class="co">##  [77] cachem_1.0.8                gower_1.0.1                </span></span>
<span><span class="co">##  [79] xfun_0.41                   S4Arrays_1.2.0             </span></span>
<span><span class="co">##  [81] mime_0.12                   prodlim_2023.08.28         </span></span>
<span><span class="co">##  [83] survival_3.5-7              timeDate_4032.109          </span></span>
<span><span class="co">##  [85] SingleCellExperiment_1.22.0 iterators_1.0.14           </span></span>
<span><span class="co">##  [87] pbmcapply_1.5.1             hardhat_1.3.0              </span></span>
<span><span class="co">##  [89] lava_1.7.3                  ellipsis_0.3.2             </span></span>
<span><span class="co">##  [91] fitdistrplus_1.1-11         ROCR_1.0-11                </span></span>
<span><span class="co">##  [93] ipred_0.9-14                nlme_3.1-164               </span></span>
<span><span class="co">##  [95] bit64_4.0.5                 RcppAnnoy_0.0.22           </span></span>
<span><span class="co">##  [97] GenomeInfoDb_1.36.4         bslib_0.6.1                </span></span>
<span><span class="co">##  [99] irlba_2.3.5.1               vipor_0.4.7                </span></span>
<span><span class="co">## [101] KernSmooth_2.23-22          rpart_4.1.23               </span></span>
<span><span class="co">## [103] colorspace_2.1-0            BiocGenerics_0.46.0        </span></span>
<span><span class="co">## [105] Hmisc_5.1-1                 nnet_7.3-19                </span></span>
<span><span class="co">## [107] ggrastr_1.0.2               tidyselect_1.2.0           </span></span>
<span><span class="co">## [109] bit_4.0.5                   compiler_4.3.1             </span></span>
<span><span class="co">## [111] htmlTable_2.4.2             hdf5r_1.3.9                </span></span>
<span><span class="co">## [113] desc_1.4.3                  DelayedArray_0.26.7        </span></span>
<span><span class="co">## [115] plotly_4.10.4               checkmate_2.3.1            </span></span>
<span><span class="co">## [117] scales_1.3.0                lmtest_0.9-40              </span></span>
<span><span class="co">## [119] stringr_1.5.1               digest_0.6.34              </span></span>
<span><span class="co">## [121] goftest_1.2-3               spatstat.utils_3.0-4       </span></span>
<span><span class="co">## [123] minqa_1.2.6                 rmarkdown_2.25             </span></span>
<span><span class="co">## [125] XVector_0.40.0              RhpcBLASctl_0.23-42        </span></span>
<span><span class="co">## [127] htmltools_0.5.7             pkgconfig_2.0.3            </span></span>
<span><span class="co">## [129] base64enc_0.1-3             lme4_1.1-35.1              </span></span>
<span><span class="co">## [131] sparseMatrixStats_1.12.2    MatrixGenerics_1.12.3      </span></span>
<span><span class="co">## [133] highr_0.10                  fastmap_1.1.1              </span></span>
<span><span class="co">## [135] rlang_1.1.3                 GlobalOptions_0.1.2        </span></span>
<span><span class="co">## [137] htmlwidgets_1.6.4           shiny_1.8.0                </span></span>
<span><span class="co">## [139] DelayedMatrixStats_1.22.6   farver_2.1.1               </span></span>
<span><span class="co">## [141] jquerylib_0.1.4             zoo_1.8-12                 </span></span>
<span><span class="co">## [143] jsonlite_1.8.8              ModelMetrics_1.2.2.2       </span></span>
<span><span class="co">## [145] RCurl_1.98-1.14             Formula_1.2-5              </span></span>
<span><span class="co">## [147] GenomeInfoDbData_1.2.10     dotCall64_1.1-1            </span></span>
<span><span class="co">## [149] patchwork_1.2.0             munsell_0.5.0              </span></span>
<span><span class="co">## [151] Rcpp_1.0.12                 reticulate_1.35.0          </span></span>
<span><span class="co">## [153] stringi_1.8.3               pROC_1.18.5                </span></span>
<span><span class="co">## [155] zlibbioc_1.46.0             MASS_7.3-60.0.1            </span></span>
<span><span class="co">## [157] plyr_1.8.9                  parallel_4.3.1             </span></span>
<span><span class="co">## [159] listenv_0.9.1               ggrepel_0.9.5              </span></span>
<span><span class="co">## [161] forcats_1.0.0               deldir_2.0-2               </span></span>
<span><span class="co">## [163] splines_4.3.1               tensor_1.5                 </span></span>
<span><span class="co">## [165] circlize_0.4.15             igraph_2.0.1.1             </span></span>
<span><span class="co">## [167] spatstat.geom_3.2-8         RcppHNSW_0.6.0             </span></span>
<span><span class="co">## [169] reshape2_1.4.4              stats4_4.3.1               </span></span>
<span><span class="co">## [171] evaluate_0.23               ggprism_1.0.4              </span></span>
<span><span class="co">## [173] nloptr_2.0.3                foreach_1.5.2              </span></span>
<span><span class="co">## [175] httpuv_1.6.14               RANN_2.6.1                 </span></span>
<span><span class="co">## [177] tidyr_1.3.1                 purrr_1.0.2                </span></span>
<span><span class="co">## [179] polyclip_1.10-6             future_1.33.1              </span></span>
<span><span class="co">## [181] clue_0.3-65                 scattermore_1.2            </span></span>
<span><span class="co">## [183] janitor_2.2.0               xtable_1.8-4               </span></span>
<span><span class="co">## [185] monocle3_1.4.3              RSpectra_0.16-1            </span></span>
<span><span class="co">## [187] later_1.3.2                 viridisLite_0.4.2          </span></span>
<span><span class="co">## [189] class_7.3-22                ragg_1.2.7                 </span></span>
<span><span class="co">## [191] tibble_3.2.1                memoise_2.0.1              </span></span>
<span><span class="co">## [193] beeswarm_0.4.0              IRanges_2.34.1             </span></span>
<span><span class="co">## [195] cluster_2.1.6               timechange_0.3.0           </span></span>
<span><span class="co">## [197] globals_0.16.2              caret_6.0-94</span></span></code></pre>
<div class="sourceCode" id="cb32"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/base/getwd.html" class="external-link">getwd</a></span><span class="op">(</span><span class="op">)</span></span></code></pre></div>
<pre><code><span><span class="co">## [1] "/Users/sfurlan/develop/scrubletR/vignettes"</span></span></code></pre>
</div>
  </main><aside class="col-md-3"><nav id="toc"><h2>On this page</h2>
    </nav></aside>
</div>



    <footer><div class="pkgdown-footer-left">
  <p></p>
<p>Developed by <a href="https://furlan-lab.github.io" class="external-link">Scott Furlan</a>.</p>
</div>

<div class="pkgdown-footer-right">
  <p></p>
<p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.0.7.</p>
</div>

    </footer>
</div>

  

  

  </body>
</html>
